<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BookStore || Xem chi tiết</title>
    <!--Bootstrap 5 CSS -->
    <link href="module/bootstrap-5.3.3-dist/css/bootstrap.min.css" rel="stylesheet" />
    <!--Font Awesome 5-->
    <link rel="stylesheet" href="module/fontawesome/css/all.min.css" />

    <!-- Popper -->

    <!--Bootstrap JS -->
    <script src="module/bootstrap-5.3.3-dist/js/bootstrap.min.js"></script>
    <script src="module/bootstrap-5.3.3-dist/js/bootstrap.bundle.min.js"></script>
    <!--Jquery -->
    <script src="module/jquery/jquery-3.7.1.min.js"></script>

    <!-- Link File CSS -->
    <link rel="stylesheet" href="asset/css/style.css" />

    <!-- link Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

    <!-- put data in localstogaren -->
    <script src="asset/js/data.js"></script>
</head>

<body>
    <header>
        <nav class=" d-flex row w-100 m-auto px-lg-5 pb-3 pb-lg-0">
            <!-- Logo -->
            <div class="logo d-flex justify-content-center col-12 col-lg-auto pt-2 pt-lg-0">
                <a href="index.html"><img src="asset/image/logo.jpg" alt="BookStore" width="125px" /></a>
            </div>

            <!-- Thẻ xuống hàng Mobile -->
            <div class="col-12 col-lg-auto">
                <hr>
            </div>

            <!-- Danh mục Pc -->
            <div class="nav-links d-none d-lg-block col-lg">
                <a href="index.html">Trang chủ</a>
                <a href="produce.html">Sản phẩm</a>
                <a href="">Giới thiệu</a>
                <a href="">Liên hệ</a>
            </div>

            <!-- Danh mục Mobile - Btn -->
            <div class="col-auto right-nav d-lg-none">
                <i class="fas fa-bars" data-bs-toggle="offcanvas" data-bs-target="#offcanvasExample"></i>
            </div>

            <!-- Danh mục Mobile - Container -->
            <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasExample"
                aria-labelledby="offcanvasExampleLabel">
                <div class="offcanvas-header">
                    <h5 class="offcanvas-title" id="offcanvasExampleLabel">Offcanvas</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                </div>
                <div class="offcanvas-body">
                    <div>
                        Some text as placeholder. In real life you can have the elements you have chosen. Like, text,
                        images, lists,
                        etc.
                    </div>
                    <div class="dropdown mt-3">
                        <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                            Dropdown button
                        </button>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#">Action</a></li>
                            <li><a class="dropdown-item" href="#">Another action</a></li>
                            <li><a class="dropdown-item" href="#">Something else here</a></li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Card & User - Icon -->
            <div class="col col-lg-4 text-left">
                <form action="">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Nhập tên sách..."
                            aria-label="Recipient's username" aria-describedby="button-addon2">
                        <button class="btn btn-outline-secondary" type="button" id="Search"><i
                                class="fa-solid fa-magnifying-glass"></i></button>
                    </div>
                </form>
            </div>

            <!-- Card & User - Container -->
            <div class="right-nav d-flex col-auto">
                <a href="#" class="d-none right-nav-icon"><i class="fa-solid fa-magnifying-glass"></i></a>
                <a href="cart.html" class=" right-nav-icon"><i class="fa-solid fa-cart-shopping"></i></a>
                <div class="dropdown">
                    <a href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i
                            class="fas fa-user"></i></a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="register.html">Đăng ký</a></li>
                        <li><a class="dropdown-item" href="login.html">Đăng nhập</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <section class="section home">
        <div class="container">
            <div class="d-flex justify-content-center" id="product-detail">
                <!--                
                <div class="card">
                    <div class="row p-4">
                        //NOTE -  sản phấm
                        <div class="col-lg-5 mb-3">
                            <div class="book-container " style="width: 50%; margin: auto;">
                                <img src="asset/image/book-1.jpg" alt="product" class="img-fluid">
                            </div>
                        </div>
                        //NOTE -  tin sản phẩm
                        <div class="col-lg-7 col-12">
                            <h2 class="fw-bold">Hiểu hết về Trà - Khoa học và nghệ thuật ẩn sau những chiếc lá</h2>
                            <div class="row">
                                <div class="col-2">
                                    <p class="detail-label">Tác giả:</p>
                                    <p class="detail-label">Thể loại:</p>
                                    <p class="detail-label">Giá sách:</p>
                                    <p class="detail-label mt-5">Số lượng:</p>
                                </div>
                                <div class="col-9">
                                    <p>AI</p>
                                    <p> Sách khoa học</p>
                                    <p class="book-price">$100.000 đ</p>
                                    <div class="row">
                                        <div class="input-group mb-5 col-2" style=" height: 10px; width: 30%;">
                                            <button class="btn btn-outline-secondary" type="button"
                                                id="button-addon1">-</button>
                                            <input type="text" class="form-control text-center" placeholder=""
                                                aria-label="Example text with button addon"
                                                aria-describedby="button-addon1" id="quantity" value="1">
                                            <button class="btn btn-outline-secondary" type="button"
                                                id="button-addon2">+</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row my-3">
                                <div class="col-lg-6">
                                    <button id="addCart" class="btn btn-outline--custom mr-2" type="button"><i
                                            class="fas fa-cart-plus"></i> Thêm vào giỏ hàng</button>
                                    <button class="btn btn--custom" id="buyNow" type="button">Mua ngay</button>
                                </div>
                            </div>

                            //NOTE -  tả
                            <h4 class="detail-label">Mô tả sách</h4>
                            <p style="text-align: justify; font-weight: 500;">
                                Hiểu hết về Trà nhắc lại một sự thật có lẽ không nhiều người chú ý: mọi loại trà ngày
                                nay, từ Lập Sơn thanh tao đến Phổ Nhĩ nồng chát, đều có chung nguồn gốc. Vậy sự khác
                                biệt là do đâu? Chính các yếu tố mang tính khoa học như địa lý, sinh học, hóa học và vật
                                lý, sự ứng dụng nhiệt và áp lực, cùng sự diệu</p>
                        </div>
                    </div>
                </div>
                 -->
            </div>
        </div>
    </section>
    <footer id="contact">
        <div class="contnaier">
            <div class="big-rows">
                <p>
                    Cung cấp những cuốn sách chất lượng nhất với dịch vụ tận tâm. Khám
                    phá thế giới sách cùng chúng tôi!
                </p>
                <div class="coical-icon">
                    <a href="#"><i class="fa-brands fa-facebook-f"></i></a>
                    <a href="#"><i class="fa-brands fa-twitter"></i></a>
                    <a href="#"><i class="fa-brands fa-instagram"></i></a>
                    <a href="#"><i class="fa-brands fa-google-plus-g"></i></a>
                </div>
            </div>

            <div class="row">
                <h2 class="title">Thông Tin</h2>
                <div class="links">
                    <a href="#">Cửa Hàng Của Chúng Tôi</a>
                    <a href="#">Giới Thiệu</a>
                    <a href="#">Kinh Doanh</a>
                    <a href="#">Giao Hàng</a>
                </div>
            </div>

            <div class="row">
                <h2 class="title">Dịch Vụ</h2>
                <div class="links">
                    <a href="#">Điều khoản sử dụng</a>
                    <a href="#">Chính sách bảo mật thông tin cá nhân</a>
                    <a href="#">Giới thiệu BookStore</a>
                    <a href="#">Hệ thống trung tâm - nhà sách</a>
                </div>
            </div>

            <div class="row">
                <h2 class="title">Liên hệ</h2>
                <div class="links">
                    <p>Địa chỉ: 123 Đường ABC, Quận XYZ, Thành phố HCM</p>
                    <p>Số điện thoại: (012) 345-6789</p>
                    <p>Email: info@bookstore.com</p>
                </div>
            </div>

        </div>

        <div class="bottom-footer">
            <div class="content">
                <p>&copy; 2024 | Tên tác giả</p>

                <div class="payment-img">
                    <img src="asset/image/payment-1.png" alt="" />
                    <img src="asset/image/payment-2.png" alt="" />
                    <img src="asset/image/payment-3.png" alt="" />
                    <img src="asset/image/payment-4.png" alt="" />
                </div>
            </div>
        </div>
    </footer>
    <script src="asset/js/script.js"></script>
    <script>
        $(document).ready(function () {

            // Lấy id từ url
            var urlParams = new URLSearchParams(window.location.search);
            var id = Number(urlParams.get('id')) || 1;
            var searchKeyword = localStorage.getItem('searchKeyword');

            // Lấy dữ liệu từ local storage
            var products = JSON.parse(localStorage.getItem('book'));
            var product = products.find(function (product) {
                return product.id == id;
            });
            //lấy tên thể loại
            var category = JSON.parse(localStorage.getItem('category'));
            var cate = category.find(function (cate) {
                return cate.id == product.id_category;
            });

            function renderDetail(product) {
                var html = `
                <div class="card">
                    <div class="row p-4">
                        <!-- ảnh sản phấm -->
                        <div class="col-lg-5 mb-3">
                            <div class="book-container " style="width: 75%; margin: auto;">
                                <img src="${product.image} " alt="product" class="img-fluid">
                            </div>
                        </div>
                        <!-- Thông tin sản phẩm -->
                        <div class="col-lg-7 col-12">
                            <h2 class="fw-bold">${product.title} </h2>
                            <div class="row">
                                <div class="col-2">
                                    <p class="detail-label">Tác giả:</p>
                                    <p class="detail-label">Thể loại:</p>
                                    <p class="detail-label">Giá sách:</p>
                                    <p class="detail-label mt-5">Số lượng:</p>
                                </div>
                                <div class="col-9">
                                    <p>${product.author}</p>
                                    <p>${cate.name}</p>
                                    <p class="book-price">$${product.price.toLocaleString('de-DE')} đ</p>
                                    <div class="row">
                                        <div class="input-group mb-5 col-2" style=" height: 10px; width: 30%;">
                                            <button class="btn btn-outline-secondary" type="button"
                                                id="button-addon1">-</button>
                                            <input type="text" class="form-control text-center" placeholder=""
                                                aria-label="Example text with button addon"
                                                aria-describedby="button-addon1" id="quantity" value="1">
                                            <button class="btn btn-outline-secondary" type="button"
                                                id="button-addon2">+</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row my-3">
                                <div class="col-lg-6">
                                    <button id="addCart" class="btn btn-outline--custom mr-2" type="button"><i
                                            class="fas fa-cart-plus"></i> Thêm vào giỏ hàng</button>
                                    <a id="buyNow" href="#" class="btn btn--custom" type="button">Mua ngay</a>
                                </div>
                            </div>

                            <!-- mô tả -->
                            <h4 class="detail-label">Mô tả sách</h4>
    
                            <p style="text-align: justify; font-size: 14px"><i>${product.description}</i></p>
                        </div>
                    </div>
                </div>
              `;
                return html;
            }
            $('#product-detail').html(renderDetail(product));

            // Số lượng
            $("#button-addon1").click(function () {
                let quantity = $("#quantity");
                if (quantity.val() > 1) {
                    quantity.val(parseInt(quantity.val()) - 1);
                }
            });
            $("#quantity").focusout(function () {
                let quantity = $(this);
                if (parseInt(quantity.val()) < 1 || isNaN(parseInt(quantity.val()))) {
                    quantity.val(1);
                }
            });

            $("#button-addon2").click(function () {
                let quantity = $("#quantity");
                quantity.val(parseInt(quantity.val()) + 1);
            });
            //Thêm vào giỏ hàng
            function addToCart(bookId, quantity) {
                var newCartItem = {
                    id: Date.now(), // đặt id cho item từ thời gian hiện tại
                    id_book: bookId,
                    quantity: quantity
                };

                var carts = JSON.parse(localStorage.getItem('cart')) || [];
                var cartItem = carts.find(item => item.id_book === bookId);

                if (cartItem) {
                    cartItem.quantity += Number(quantity);
                } else {
                    carts.push(newCartItem);
                }
                localStorage.setItem('cart', JSON.stringify(carts));

            }

            $("#buyNow").click(function () {
                //dừng thẻ a
                event.preventDefault();
                var bookId = id;
                var quantity = Number($("#quantity").val());
                addToCart(bookId, quantity);
                window.location.href = 'cart.html';
            });

            $("#addCart").click(function () {
                var bookId = id;
                var quantity = Number($("#quantity").val());
                addToCart(bookId, quantity);
                alert('Thêm vào giỏ hàng thành công');
            });


        });
    </script>
</body>

</html>